name = "corvo-cortex"
main = "src/index.ts"
compatibility_date = "2024-01-01"

# KV Namespaces
# NOTE: Update these IDs after creating production namespaces
[[kv_namespaces]]
binding = "CORTEX_CLIENTS"
id = "test_clients_namespace"
preview_id = "test_clients_namespace_preview"

[[kv_namespaces]]
binding = "CORTEX_CONFIG"
id = "test_config_namespace"
preview_id = "test_config_namespace_preview"

# Durable Objects
[[durable_objects.bindings]]
name = "CIRCUIT_BREAKER"
class_name = "CircuitBreaker"

# Migrations
[[migrations]]
tag = "v1"
new_sqlite_classes = ["CircuitBreaker"]

# Environment variables
[vars]
ENVIRONMENT = "development"

# Credit flags (set via wrangler variable put)
# CREDITS_ANTHROPIC = "true"
# CREDITS_OPENAI = "true"

# Production secrets (set via: wrangler secret put <NAME> --env production)
# ANTHROPIC_API_KEY
# OPENAI_API_KEY
# ZAI_API_KEY
# OPENROUTER_API_KEY
# LANGFUSE_PUBLIC_KEY
# LANGFUSE_SECRET_KEY

# Production configuration
[env.production]
name = "corvo-cortex-pro"

# Production KV Namespaces (preview namespaces are separate from production)
[[env.production.kv_namespaces]]
binding = "CORTEX_CLIENTS"
id = "8607bc102781438a8e1ea9d481a5a12b"
preview_id = "4ca65fdcb36c4352a6992e6775e52862"

[[env.production.kv_namespaces]]
binding = "CORTEX_CONFIG"
id = "37c450a7bdc74db4aebff10aac98ff57"
preview_id = "ae27bfa48e1a478cb2344c543cea106a"

# Production Durable Objects
[[env.production.durable_objects.bindings]]
name = "CIRCUIT_BREAKER"
class_name = "CircuitBreaker"

[[env.production.migrations]]
tag = "v1"
new_sqlite_classes = ["CircuitBreaker"]

# Production Environment Variables and Credit Flags
[env.production.vars]
ENVIRONMENT = "production"
CREDITS_ANTHROPIC = "true"
CREDITS_OPENAI = "true"
